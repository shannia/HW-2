---
title: "MATH 216 Homework 2"
author: "Shannia Fu"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    smooth_scroll: false
---

```{r, echo=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(readr) 
library(forcats)
url <- "https://github.com/rudeboybert/JSE_OkCupid/blob/master/profiles.csv.zip?raw=true"
temp_zip_file <- tempfile()
download.file(url, temp_zip_file)
unzip(temp_zip_file, "profiles.csv")
```


```{r, echo=FALSE, message=FALSE, cache=TRUE}
# Do not edit this code block. By setting cache=TRUE, we are saving the output 
# of this block to the cache. That way it only needs to run once.  This is
# especially useful for portions of code that take a long time to run.
profiles <- read_csv(file="profiles.csv")
```



## Admistrative:

Please indicate

* Who you collaborated with:
* Roughly how much time you spent on this HW so far: 2 hours
* The URL of the RPubs published URL [here](http://rpubs.com/shannia/hw2).
* What gave you the most trouble: reordering things, wrapping labels on the x-axis
* Any comments you have:



## Question 1:

Perform an Exploratory Data Analysis (EDA) on the `profiles` data set,
specifically on the relationship between gender and

* `income`
* `job`
* One more categorical variable of your choice

all keeping in mind in HW-3, you will be fitting a logistic regression to
predict a user's gender based on these variables.

```{r, echo=TRUE, message=TRUE, warning=TRUE, fig.width=8, fig.height=4.5}
#income
income_relation <- profiles %>% 
  filter(income > 1 & income <= 500000) 
ggplot (income_relation, aes(x=sex, y=income)) + geom_boxplot()
#job
job_relation <- profiles %>% 
  mutate(job = ifelse(is.na(job), "NA", job))
ggplot(job_relation, aes(sex, fill=factor(job))) +
  geom_bar(position="dodge") +
  labs(title="Number of Jobs by Gender", x="Job", y="Count", fill="Sex")
#code that graphs by job and separates by sex
#I tried using this but making the labels wrap was extremely difficultsion 
#ggplot(job_relation, aes(job, fill=factor(sex))) +
#  geom_bar(position="dodge") +
#  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 10, simplify = FALSE), paste, collapse="\n")) +
#  labs(title="Number of Jobs by Gender", x="Job", y="Count", fill="Sex")
#drinks
drinking_relation <- profiles %>% 
  mutate(drinks=ifelse(is.na(drinks), "NA", drinks))
drinking_relation$drinks <- factor(drinking_relation$drinks, levels = c("NA", "not at all", "rarely", "often", "socially", "very often", "desperately"))
ggplot(drinking_relation, aes(drinks, fill=factor(sex))) +
  geom_bar(position="dodge") +
  labs(title="Drinking level by Gender", x="Drinking Level", y="Count", fill="Sex")
```



## Question 2:

In the file `HW-2_Shiny_App.Rmd`, build the Shiny App discussed in Lec09 on
Monday 10/3: Using the `movies` data set in the `ggplot2movies` data set, make a
Shiny app that

* Plots budget on the x-axis and rating on the y-axis
* Instead of having a radio button to select the genre of movie (`Action`,
`Animation`, `Comedy`, etc), have a radio button that allows you to toggle
between comedies and non-comedies. This app should be simpler.

